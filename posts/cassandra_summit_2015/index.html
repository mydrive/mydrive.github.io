<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Notes on Cassandra Summit 2015</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Notes and highlights from Cassandra Summit 2015">
    <meta name="author" content="MyDrive Solutions">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
<link href='/assets/stylesheets/bootstrap.min-88238289010db19359d2181e634e95cd.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/style-e81fa375b231bedf6cb2dbc6653570cc.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/google_prettify/sons-of-obsidian-afb0925bfa2d994f17dab93e13fbf999.css' type='text/css' rel='stylesheet' media='all'>
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  <link rel="shortcut icon" href="/assets/media/favicon.ico">
  </head>

  <body>

    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">MyDrive Engineering</a>
          <ul class="nav">
              
                <li><a href="/archive">Archive</a></li>
              
              
                <li><a href="/tags">Tags</a></li>
              
              
                <li><a href="/categories">Categories</a></li>
              
          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
          by <strong>Carlos Alonso Perez</strong>
  <p>Software Engineer</p>
  <p><a href="https://twitter.com/calonso" target="_blank">@calonso</a></p>

<div class="page-header">
  <h1>Notes on Cassandra Summit 2015 </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>2015-10-27</strong>
    </div>
    <div class="content">
      <h1 id="toc_0">Cassandra Summit 2015</h1>

<p><img src="/assets/media/cassandra_summit_2015.png" alt="Cassandra Summit "></p>

<p>DataStax Cassandra Summit is becoming a GREAT conference!! With each new edition more and more people, talks and activities are adding themselves to the event to make it really awesome.</p>

<p>This year has been very special and intense for me, for several reasons.</p>

<ul>
<li><p>First because of the location. This year, the Summit was held in Santa Clara, CA. Which meant an opportunity for me to know the area, including San Francisco and The Bay. I&#39;ve really enjoyed walking and visiting the city&#39;s touristic attractions. San Francisco is a lovely city and the weather has been just amazing, but I wouldn&#39;t like to close this note without mentioning the reality of the streets. It is simply incredible the amount of homeless and people suffering mental diseases you can see just by walking the city. And it seems that the situation is getting worse as the housing prices increase. This article on the news particularly caught my attention: <a href="http://www.sfchronicle.com/business/article/Tech-bus-drivers-forced-to-live-in-cars-to-make-6517928.php">Tech bus drivers forced to live in cars to make ends meet</a>.</p></li>
<li><p>Second reason is because I have spoken there!! This has been, by far, the biggest conference I&#39;ve had the pleasure to speak at. And I really enjoyed it!! The talk was actually a live coding demo (best kind of talks for sure, aren&#39;t they?) showing how I, being a Cassandra developer, not admin, tackled a production issue a couple of months ago. You can see the exact steps in <a href="http://engineering.mydrivesolutions.com/posts/cassandra_10_seconds_back/">this previous blog post</a> and also in <a href="https://www.youtube.com/watch?v=nwscaRTmVCM">this video</a> of this same talk in <a href="http://www.meetup.com/Cassandra-London/events/224555591/">the London Cassandra Meetup</a>.</p></li>
<li><p>Third reason is because I&#39;ve been officially certified as an Apache Cassandra Developer by DataStax and O&#39;Reilly Media: <a href="https://twitter.com/calonso/status/646480545514258432">https://twitter.com/calonso/status/646480545514258432</a></p></li>
<li><p>And finally, because I&#39;ve been awarded with one of <a href="http://www.planetcassandra.org/mvps/">the DataStax MVPs of the year 2015</a>!! And, to be honest, I couldn&#39;t be more excited. I love Cassandra and I love contributing to OS projects and getting some recognition on it is always welcome. I&#39;d like to congratulate every other MVP of this year (full roster to be announced soon) and the whole DataStax for such a great and well organised event.</p></li>
</ul>

<h2 id="toc_1">Tech Notes. Day 1</h2>

<p>And after all this personal notes let&#39;s go into the technical notes I&#39;ve made from the talks I&#39;ve attended. Hope you find them interesting!!</p>

<blockquote>
<p><a href="http://esri.github.io/">http://esri.github.io/</a> project and it&#39;s <a href="https://github.com/Esri/gis-tools-for-hadoop">GIS tools for Hadoop subproject</a></p>
</blockquote>

<p>This first one is a project to check out and bear in mind always when working with geospatial data and corresponding visualisations.</p>

<blockquote>
<p>Time series writing performance can be improved by buffering</p>
</blockquote>

<p>This is pretty simple. If you do some buffering in your application and write bigger chunks of data, rather than doing one write per observation. It&#39;s likely that your overall performance goes up.</p>

<h3 id="toc_2">PagerDuty&#39;s &#39;One year of Cassandra failures&#39;</h3>

<p>PagerDuty&#39;s talk about their infrastructure was really interesting to me, as it somehow resembles ours.</p>

<blockquote>
<p>Watch to dropped messages counts. They anticipate bigger issues</p>

<p>Upgrade Cassandra. At least to the corresponding latest DSE&#39;s version.</p>

<p>The Cassandra Danger Metrics page.</p>
</blockquote>

<p>Having a Dashboard of danger metrics to look at can be very useful. This should include pending tasks and latencies at least.</p>

<h3 id="toc_3">The Weather Company</h3>

<p><a href="https://twitter.com/rs_atl">Robbie Strickland&#39;s</a> was one of my favourite ones. I found it really dense and intense. Lots of notes here.</p>

<p><img src="/assets/media/weather_co_infrastructure.png" alt="The Weather Company Architecture"></p>

<p>First of all is to check Robbie&#39;s book <a href="http://www.amazon.co.uk/Cassandra-High-Availability-Robbie-Strickland/dp/1783989122">Cassandra High Availability</a></p>

<blockquote>
<p>Be careful when using DTCS. It is dangerous.</p>
</blockquote>

<p>Compactions in Cassandra have to be deeply understood, otherwise they will simply bite you sooner or later.</p>

<blockquote>
<p>Process and filter your events at ingestion time.</p>
</blockquote>

<p>That makes sense. Instead of having unstructured data, parse and process your data before ingesting it and that way you&#39;ll be able to filter invalid data if necessary. If you don&#39;t do it, you&#39;ll have to parse and process every time you read, which is definitely worse.</p>

<p>And speaking particularly on his lambda architecture (in the picture), a couple of ideas:</p>

<ul>
<li>  Daily backup data from C* to S3 + Parquet. C* writes quickly but is more expensive than S3 for long term storage. Compute analytics at C* and dump when data is not likely to be required anymore.</li>
<li>  Beware versions: Spark + Cassandra = 2.1.8</li>
<li>  The usage of secondary indexes to help Spark reading data is a good practice, but keeping index cardinality low (&lt;= 50k)</li>
<li>  Beware wide rows, it only takes one to get you in trouble. Use <code>nodetool toppartitions</code> or <code>nodetool cfstats Max row bytes</code></li>
<li>  Make your data visualisable ASAP: <a href="http://zeppelin-project.org/">Zeppelin project</a></li>
</ul>

<h2 id="toc_4">Tech Notes. Day 2</h2>

<h3 id="toc_5">Netflix</h3>

<p><a href="https://twitter.com/chriskalan">Christos Kalantzis</a> and his colleagues&#39; talk about how they survived AWS re:boot gave as well lots of notes:</p>

<ul>
<li>  Run periodic checks on each nodes&#39; health, using, for example, Jenkins.</li>
<li>  They use internal products <a href="https://github.com/Netflix/atlas">Atlas</a> and <a href="https://github.com/Netflix/Priam">Priam</a> for managing and monitoring the cluster.</li>
<li>  Have idempotent processes.</li>
<li>  Retry with exponential back-off.</li>
<li>  Collect data/stats on your clusters to predict failures.</li>
<li>  No ops team. Everyone acts as devops and gets on-call.</li>
</ul>

<h3 id="toc_6">Troubleshooting with Cassandra</h3>

<p>This talk from a DataStax&#39;s support engineer left several notes as well:</p>

<ul>
<li>  If cache is full but the hit rate is low, increase cache capacity.</li>
<li>  If <code>memtableflushwriter:All time blocked</code> jobs is significant means disk pressure on writes.</li>
<li>  <code>proxyhistograms</code> command shows the full time to process the request, including the network round-trip from the coordinator to the required replicas. By contrast, the <code>cfhistograms</code> command shows the local latency for a single replica.</li>
<li>  Use <code>describecluster</code> for schema disagreements.</li>
<li>  Log warns with &#39;Compacting large partition&#39; message when if encounters a big partition that you should take care of.</li>
</ul>

<h3 id="toc_7">Lessons learnt with Cassandra and Spark</h3>

<p>This talk by <a href="https://twitter.com/bradfordcp">Christopher Bradford</a> from <a href="https://twitter.com/o19s">OpenSourceConnections</a> gave me some architectural notes.</p>

<ul>
<li>  Their architecture is composed by Cassandra to store data, Spark to ETL and Solr to search. An example of this setup is in their github account: <a href="https://github.com/o19s/Spark-Cassandra-Demo">https://github.com/o19s/Spark-Cassandra-Demo</a></li>
<li>  Build balanced models: spread data/load evenly across all nodes.</li>
<li>  Use vnodes in small clusters. Single token nodes if you&#39;re big (Apple, Netflix, ...)</li>
<li>  Have a look at <a href="https://dropwizard.github.io/metrics/3.1.0/">Metrics</a>: <a href="http://www.dropwizard.io/">Dropwizard</a>&#39;s Java profiler project.</li>
</ul>

<h3 id="toc_8">Extreme Cassandra Optimization.</h3>

<p>I must admit this talk by <a href="https://twitter.com/AlTobey">Al Tobey</a> was a bit out of reach for me. There were so many advanced optimisation tips that I can only link to his guide to come back to it when I get the appropriate level: <a href="https://tobert.github.io/pages/als-cassandra-21-tuning-guide.html">Al&#39;s Cassandra 2.1 tunning guide</a></p>

<h3 id="toc_9">Repeatable, Scalable, Reliable, Observable: Cassandra</h3>

<p>This talk by <a href="https://twitter.com/aaronmorton">Aaron Morton</a> had sooooo many notes on how to monitor Cassandra that at a given point I decided to give up and simply grab the slides later to review them. REALLY GOOD!!! <a href="http://www.slideshare.net/aaronmorton/cassandra-sf-2015-repeatable-scalable-reliable-observable-cassandra">http://www.slideshare.net/aaronmorton/cassandra-sf-2015-repeatable-scalable-reliable-observable-cassandra</a></p>

<h3 id="toc_10">Case Study: Troubleshooting production issues as a developer.</h3>

<p>And that was my talk!! A live coding demo!! I have to massively thank to everyone who attended to it as that was the last slot and I acknowledge everyone was already kind of burnout of Cassandra and I also hope they enjoyed it and found it valuable.</p>

<p>Here you can see a video of the same talk during the [Cassandra London Meetup][5] and the slides as well:</p>

<ul>
<li>  <a href="http://bit.ly/1P3ZFq4">Slides</a></li>
<li>  <a href="http://bit.ly/1LiUS4p">Video</a></li>
</ul>

<p>And that&#39;s about it!! Hope this notes are as useful for you guys as they&#39;re for me and a HUGE THANKS to everyone who spoke at the Summit for sharing such a valuable knowledge.</p>

    </div>
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      <li>
        <a href="/categories#conferences-ref">conferences <span>1</span></a>
      </li>
      <li>
        <a href="/categories#talks-ref">talks <span>1</span></a>
      </li>
    </ul>
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      <li>
        <a href="/tags#Cassandra-ref">Cassandra <span>5</span></a>
      </li>
      <li>
        <a href="/tags#NoSQL-ref">NoSQL <span>1</span></a>
      </li>
      <li>
        <a href="/tags#DataStax-ref">DataStax <span>1</span></a>
      </li>
    </ul>
    <hr>
    <div class="pagination">
      <ul>
          <li class="prev"><a href="/posts/docker_at_accu_2015" title="Docker at ACCU 2015">&larr; Previous</a></li>

          <li><a href="/archive">Archive</a></li>

          <li class="next"><a href="/posts/cassandra_nodes_replacement" title="Cassandra instantaneous in place node replacement">Next &rarr;</a></li>
      </ul>
    </div>
    <hr>
    
  </div>
</div>


      </div>

      <hr>
      <div class="footer">
        <p>&copy; <a href="http://mydrivesolutions.com" target="_blank">MyDrive Solutions Limited</a> 2014
          with help from <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </div>

    </div> <!-- /container -->

    <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint linenums";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32835100-1']);
  _gaq.push(['_trackPageview']);
  

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


    
  </body>
</html>
